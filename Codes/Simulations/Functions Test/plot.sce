clear
clc
t=[0.000000 0.000260 0.000520 0.000780 0.001040 0.001300 0.001560 0.001820 0.002080 0.002340 0.002600 0.002860 0.003120 0.003380 0.003640 0.003900 0.004160 0.004420 0.004680 0.004940 0.005200 0.005460 0.005720 0.005980 0.006240 0.006500 0.006760 0.007020 0.007280 0.007540 0.007800 0.008060 0.008320 0.008580 0.008840 0.009100 0.009360 0.009620 0.009880 0.010140 0.010400 0.010660 0.010920 0.011180 0.011440 0.011700 0.011960 0.012220 0.012480 0.012740 0.013000 0.013260 0.013520 0.013780 0.014040 0.014300 0.014560 0.014820 0.015080 0.015340 0.015600 0.015860 0.016120 0.016380 ]
V=[0.00 17.58 34.98 52.06 68.63 84.54 99.64 113.79 126.84 138.68 149.18 158.25 165.80 171.76 176.08 178.70 179.60 178.79 176.25 172.03 166.15 158.68 149.68 139.25 127.48 114.48 100.39 85.34 69.46 52.92 35.87 18.47 0.90 -16.68 -34.10 -51.19 -67.79 -83.74 -98.89 -113.09 -126.20 -138.10 -148.67 -157.82 -165.45 -171.50 -175.90 -178.61 -179.60 -178.87 -176.42 -172.28 -166.49 -159.10 -150.18 -139.82 -128.11 -115.18 -101.14 -86.13 -70.29 -53.78 -36.75 -19.37 ]
I=[0.00 5.81 11.57 17.22 22.70 27.96 32.95 37.63 41.95 45.86 49.33 52.33 54.83 56.80 58.23 59.10 59.40 59.13 58.29 56.89 54.95 52.48 49.50 46.05 42.16 37.86 33.20 28.22 22.97 17.50 11.86 6.11 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 ]

X_ABS=[0.995428 5751.921387 12.249238 6.906994 4.926222 3.862976 3.192668 2.730073 2.391951 2.134210 1.930950 1.767239 1.633343 1.521752 1.427796 1.347663 1.279474 1.220438 1.169375 1.125210 1.086596 1.053200 1.024105 0.998898 0.977350 0.958845 0.943399 0.930419 0.920233 0.912358 0.906814 0.903839 0.902388 0.903472 0.906813 0.912321 0.920233 0.930500 0.943399 0.958549 0.977350 0.999003 1.024105 1.053159 1.086596 1.125308 1.169374 1.220642 1.279474 1.347958 1.427796 1.521638 1.633343 1.767367 1.930949 2.133646 2.391950 2.730582 3.192669 3.862590 4.926223 6.907466 12.249239 5751.921387 ]
f=[0.000000 60.000000 120.000000 180.000000 240.000000 300.000000 360.000000 420.000000 480.000000 540.000000 600.000000 660.000000 720.000000 780.000000 840.000000 900.000000 960.000000 1020.000000 1080.000000 1140.000000 1200.000000 1260.000000 1320.000000 1380.000000 1440.000000 1500.000000 1560.000000 1620.000000 1680.000000 1740.000000 1800.000000 1860.000000 1920.000000 1980.000000 2040.000000 2100.000000 2160.000000 2220.000000 2280.000000 2340.000000 2400.000000 2460.000000 2520.000000 2580.000000 2640.000000 2700.000000 2760.000000 2820.000000 2880.000000 2940.000000 3000.000000 3060.000000 3120.000000 3180.000000 3240.000000 3300.000000 3360.000000 3420.000000 3480.000000 3540.000000 3600.000000 3660.000000 3720.000000 3780.000000 ]
X_ANG=[0.00 1.00 0.00 5751.92 -12.34 12.25 7.96 6.91 5.80 4.93 -1.21 3.86 1.70 3.19 0.27 2.73 -0.29 2.39 -0.81 2.13 -1.54 1.93 -3.00 1.77 -8.72 1.63 16.30 1.52 4.64 1.43 2.79 1.35 2.01 1.28 1.58 1.22 1.29 1.17 1.08 1.13 0.92 1.09 0.79 1.05 0.69 1.02 0.59 1.00 0.51 0.98 0.44 0.96 0.38 0.94 0.31 0.93 0.26 0.92 0.20 0.91 0.15 0.91 0.10 0.90 ]

//X_ABS_log=[]
for i = 1:length(X_ABS)
    X_ABS_log(i)=abs(log(X_ABS(i)))
end

clf(0)
scf(0)
plot(t,V,t,I)
hl=legend(["Tensão";"Corrente"])
xlabel("Tempo (s)")
ylabel("Tensão(V)/Correte(A)")
xtitle("Tensão/Corrente x Tempo (Angelo Polotto)")

clf(1)
scf(1)
//a=gca(1)
//a.thickness = 2;
plot2d3(f,X_ABS_log) 
//plot(f,X_ABS)
hl=legend(["Frequencia"])
xlabel("Freq (Hz)")
ylabel("|log(Magnitude)|")
xtitle("FFT (Angelo Polotto)")

